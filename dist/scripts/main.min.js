"use strict";import per from"../scripts/personage.js";let runnerCanvas=document.getElementById("runner"),runnerContext=runnerCanvas.getContext("2d"),timeCount=!0;function clearCanvas(){runnerContext.clearRect(0,0,runnerCanvas.offsetWidth,runnerCanvas.offsetHeight)}function renderCanvas(){grassMain(),listGrass.map(t=>t.render(runnerContext))}function grassMain(){runnerContext.fillStyle="#025415",runnerContext.fillRect(0,580,880,50)}let hero={oldPosition:{y:0,addValue(){this.y=hero.currentPosition.y}},currentPosition:{x:0,y:0,addValue(){this.x=hero.body.x,this.y=hero.body.y}},body:{color:"#0474ba",x:10,y:545,width:33,height:30,moveBody(){setTimeout(()=>{clearCanvas(),this.y+=2,renderCanvas(),hero.render()},400),setTimeout(()=>{clearCanvas(),this.y-=2,renderCanvas(),hero.render()},600)},render(){runnerContext.fillStyle=this.color,runnerContext.fillRect(this.x,this.y,this.width,this.height),hero.currentPosition.x=this.x,hero.currentPosition.y=this.y}},eyes:{color:"#71c2f5",leftX:20,rightX:33,y:555,width:8,heihgt:6,position:"right",leftMove(){this.leftX-=6,this.rightX-=5},rightMove(){this.leftX+=6,this.rightX+=5},render(){runnerContext.fillStyle=this.color,runnerContext.fillRect(this.leftX,this.y,this.width,this.heihgt),runnerContext.fillRect(this.rightX,this.y,this.width,this.heihgt)}},leg:{color:"#4e738a",leftX:10,rightX:31,y:575,width:12,leftHeihgt:5,rightHeihgt:5,activeLeg:"static",moveLeg(){"static"==this.activeLeg?(this.activeLeg="left",this.leftHeihgt-=2):"left"==this.activeLeg?(this.activeLeg="right",this.leftHeihgt=5,this.rightHeihgt-=2):"right"==this.activeLeg&&(this.activeLeg="left",this.rightHeihgt=5,this.leftHeihgt-=2)},render(){runnerContext.fillStyle=this.color,runnerContext.fillRect(this.leftX,this.y,this.width,this.leftHeihgt),runnerContext.fillRect(this.rightX,this.y,this.width,this.rightHeihgt)}},render(){this.body.render(),this.leg.render(),this.eyes.render()},moveLeft(){runnerContext.clearRect(0,0,runnerCanvas.offsetWidth,runnerCanvas.offsetHeight),"right"==this.eyes.position&&(this.eyes.leftMove(),this.eyes.position="left"),this.leg.moveLeg(),this.body.x-=5,this.leg.leftX-=5,this.leg.rightX-=5,this.eyes.leftX-=5,this.eyes.rightX-=5,this.currentPosition.addValue(),this.render(),grassMain()},moveRight(){runnerContext.clearRect(0,0,runnerCanvas.offsetWidth,runnerCanvas.offsetHeight),"left"==this.eyes.position&&(this.eyes.rightMove(),this.eyes.position="right"),this.leg.moveLeg(),this.body.x+=5,this.leg.leftX+=5,this.leg.rightX+=5,this.eyes.leftX+=5,this.eyes.rightX+=5,this.currentPosition.addValue(),this.render(),grassMain()},jumpUp(){let t=0;setInterval(()=>{t<35&&(t+=7,runnerContext.clearRect(0,0,runnerCanvas.offsetWidth,runnerCanvas.offsetHeight),"right"==this.eyes.position?(this.body.x+=7,this.leg.leftX+=7,this.leg.rightX+=7,this.eyes.leftX+=7,this.eyes.rightX+=7):(this.body.x-=7,this.leg.leftX-=7,this.leg.rightX-=7,this.eyes.leftX-=7,this.eyes.rightX-=7),this.body.y-=5,this.eyes.y-=5,this.leg.y-=5,this.currentPosition.addValue(),this.render(),renderCanvas())},70)},jumpDowm(){let t=0;setInterval(()=>{t<35&&(t+=7,runnerContext.clearRect(0,0,runnerCanvas.offsetWidth,runnerCanvas.offsetHeight),"right"==this.eyes.position?(this.body.x+=2,this.leg.leftX+=2,this.leg.rightX+=2,this.eyes.leftX+=2,this.eyes.rightX+=2):(this.body.x-=2,this.leg.leftX-=2,this.leg.rightX-=2,this.eyes.leftX-=2,this.eyes.rightX-=2),this.body.y+=5,this.eyes.y+=5,this.leg.y+=5,this.currentPosition.addValue(),this.render(),renderCanvas())},70)},dead(){}};function obstacles(){}grassMain(),hero.render(),hero.body.moveBody(),hero.oldPosition.addValue(),document.onkeydown=t=>{if(timeCount){switch(timeCount=!1,t.keyCode){case 37:hero.currentPosition.x<5?console.log("Край карты"):(contactGrass(),hero.moveLeft());break;case 38:"left"==hero.eyes.position?hero.currentPosition.x<45?console.log("Прижок не возможен. Край карты слишком близко!"):hero.oldPosition.y==hero.currentPosition.y&&(hero.jumpUp(),contactGrass(),setTimeout(()=>{hero.jumpDowm()},390)):hero.currentPosition.x>runnerCanvas.getAttribute("width")-90?console.log("Прижок не возможен. Край карты слишком близко!"):hero.oldPosition.y==hero.currentPosition.y&&(hero.jumpUp(),contactGrass(),setTimeout(()=>{hero.jumpDowm()},390));break;case 39:hero.currentPosition.x>runnerCanvas.getAttribute("width")-hero.body.width-10?console.log("Край карты"):(contactGrass(),hero.moveRight())}renderCanvas(),setTimeout(()=>{timeCount=!0},100)}};class Obstacles{constructor(t,e,s,i,r,o){this.height=o,this.width=r,this.color=e,this.x=s,this.y=i,this.id=t}move=()=>{this.y+=5};render=t=>{t.fillStyle=this.color,t.fillRect(this.x,this.y,this.width,this.height)}}let listGrass=[],grass1=new Obstacles(1,"#025415",50,560,80,20),grass2=new Obstacles(2,"#025415",130,570,50,20),grass3=new Obstacles(3,"#025415",180,560,700,20);function contactGrass(){console.log(hero.currentPosition);for(let t=0;t<listGrass.length;t++)hero.currentPosition.y+12==listGrass[t].y&&hero.currentPosition.x==listGrass[t].x&&console.log(!0),hero.currentPosition.x==listGrass[t].x&&console.log(!1)}listGrass.push(grass1),listGrass.push(grass2),listGrass.push(grass3),setInterval(()=>{renderCanvas(),hero.render(),hero.body.moveBody(),hero.oldPosition.addValue()},1e3);